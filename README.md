# kc_final_project
karpov.courses final project of data analytic course
## TASK
На выбор предоставлены несколько тестовых заданий крупных российских и зарубежных компаний, одно из которых нужно выполнить для успешного завершения курса. Как и в реальной жизни, точные критерии оценивания неизвестны: ваша задача – показать себя нанимающему менеджеру как технически и методологически подготовленного специалиста. Команда курса не будет помогать с выполнением этих заданий.
### ALERT
Данный вариант итогового проекта является примером тестового задания из компании OZON. Он отличается от других вариантов повышенной сложностью заданий, а также большим количеством заданий на SQL. В случае успешного решения, отличных комментариев ревьюера и наличии вашего желания мы рекомендуем вас в команду OZON.

## Задание 1
В данном задании вам предлагается написать несколько SQL-запросов для определенных таблиц. В каждом случае вам НЕ будет предоставленна таблица в явном виде. Однако, вам будет дан пример таблицы с данными.

1. Посчитать % изменение количества клиентов, совершивших покупку, месяц-к-месяцу (пример таблицы приведен ниже)

| client_id | order_id | order_date |
|----------------|:---------:|----------------:|
| 1	 | 11486 |2021-01-01 |
| 2 | 11634 | 2020-12-29 |
| 1234 | 10232 | 2021-01-12 |
| 2 | 11825 | 2020-12-08 |
| ... | ... | ... |
| 90 | 10957 | 2021-01-04 |

2. Вывести сумму GMV (Gross Merchandise Value) с нарастающим итогом по дням (приер таблицы приведен ниже).

| fact_date | gmv |
|----------------|:---------:|
|2021-01-01 | 	4372888 |
| 2020-12-29 | 9556268 |
| 2021-01-12 | 2752858 |
| 2020-12-08 | 8701993 |
| ... | ... |
| 2021-01-04 | 7779666 |

3. Получить время отклика на каждое письмо (письмо идентифицируется по полю **mail_id**), отправленное пользователем **mr_employee@ozon.ru**.

Дана таблица с логом электронных писем пользователя **mr_employee@ozon.ru** (т.е. письма, отправленные с этой электронной почты и полученные на нее). У всех цепочек сообщений уникальная тема. В одной цепочкеможет быть несколько писем (приер таблицы приведен ниже).

| mail_id | mail_from | mail_to | mail_subject | timestamp |
|----------------|:---------:|:---------:|:---------:|:---------:|
| 1	| mr_employee@ozon.ru	| ms_intern@ozon.ru |	Задание для практики |	2021-01-08 12:00:03 |
| 2	| ms_intern@ozon.ru	| mr_employee@ozon.ru |	Задание для практики |	2021-01-10 13:41:34 |
| 3	| mr_employee@ozon.ru	| mr_boss@ozon.ru	| Отчет по продажам | 2021-01-10	2021-01-11 15:02:57 |
| 4	| mr_boss@ozon.ru	| mr_employee@ozon.ru	| Отчет по продажам | 2021-01-10	2021-01-18 11:03:08 |
| 5	| stranger@ozon.ru	| mr_employee@ozon.ru	| Хотите заработать денег? |	2021-01-18 12:16:44 |
| 6	| mr_employee@ozon.ru |	ms_intern@ozon.ru	| Задание для практики |	2021-01-20 19:48:54 |
| ... |	...	| ...	| ...	| ... | 

4. Вывести id сотрудников с разницей в заработной плате в пределах 5000 рублей (приер таблицы приведен ниже).

| employee_id | salary_rub |
|----------------|:---------:|
| 1 | 	100000 |
| 2 | 104000 |
| 3 | 68000 |
| ... | ... |


## Задание 2 - Case Study. Опыт продавца
**Схемы работы Маркетплейса**
Маркетплейс OZON предлагает продавцам несколько схем для сотрудничества, среди них выделяют:
- **FBO (Fulfilment by OZON)** – продавец размещает товары на складе маркетплейса. Маркетплейс сам отвечает за складскую обработку и логистику заказа до клиента. Доход площадки складывается из комиссии за витрину, складские операции и логистику.
- **FBS (Fulfilment by seller)** – продавец самостоятельно хранит товары на своём складе и отвечает за складскую обработку. После получения заказа в Личном кабинете (ЛК), продавец его обрабатывает и передаёт в логистику Маркетплейса. Доход площадки складывается из комиссии за витрину и логистику.
- **FBS 2.0 / Real FBS / DBS (Delivery by seller)** – продавец самостоятельно хранит товары на своём складе и отвечает за складскую обработку. После получения заказа в Личном кабинете (ЛК) продавец его обрабатывает и передаёт в любую удобную ему логистику. Доход площадки складывается из комиссии за витрину.

**Личный кабинет продавца**
Для начала своей работы продавец проходит регистрацию в **личном кабинете** продавца . Для получения первого заказа необходимо настроить параметры товаров, складов, логистики. Процесс занимает некоторое время, и продавец может уйти с площадки, так и не запустив продажи.

### Задание к Case Study

1. Нарисовать процесс регистрации и выхода продавца на Маркетплейс от момента регистрации до 1-ой продажи по схеме DBS и описать основные отличия от схемы FBO и FBS;

2. Описать основные сложности, которые могут возникнуть на каждом этапе с момента регистрации и первой продажи по схеме DBS;

3. Разработать метрики, которые на ваш взгляд могут показать ключевые отличия в процессах между указанными выше схемами работы;

4. Установить нормативные значения (KPI) по метрикам и обосновать релевантность и реалистичность этих KPI

## Задание 3
**Метрики** — показатели, с помощью которых измеряют эффективность процессов на каждом этапе.

Суть **метрики** - придумать такой численный показатель, который бы наиболее репрезентативно и одним числом показывал положение дел в конкретном процессе. Также, метрику должно быть удобно отслеживать в динамике, чтобы понимать, повлияли ли улучшения в бизнес-процессах положительно на какие-то аспекты бизнеса, или же отрицательно.

1. Посчитать **OnTime** - Метрика своевременности доставки. (Доставили в плановую дату доставки или нет), в %

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада, по таймслотам;

2. Посчитать **PromisedClick2Delivery** - метрика обещанного срока доставки (от даты заказа до первой плановой даты доставки), в сутках.

 - Необходима динамика по дням, неделям, месяцам;

 - Необходимо сравнение перевозчиков;

 - Необходимо понимание уровня метрики из кластера в кластер.

3. Посчитать **Click2Delivery** - метрика фактического срока доставки (от даты заказа до момента вручения), в сутках.

 - Необходимо сравнение с метрикой **PromisedClick2Delivery**;

 - Необходимо понимание кластеров, где заказы доставляются быстрее, чем мы обещаем клиентам;

4. Посчитать **GMV Accepted** - метрика совокупного объема продаж (считается по заказам, оформленным в указанный день), в рублях.

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада;

5. Посчитать **Return Rate** - доля возвратов (отношение количества возвратов к заказам в этот день), в %.

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по кластерам склада и клиента;

6. Посчитать **GMV D-R** - метрика, отражающая совокупный объем доставленных заказов за вычетом возвратов, в рублях.

 - Необходимо видеть изменение метрики по дням (для всех дней, которые были раньше, чем дата расчета метрики);

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада.

Описание таблиц
*Все данные находятся в табличном виде в Clickhouse*
Таблица **logistic_online** содержит данные о логистике.

**date_order** - дата, в которую клиент оформляет заказ

**number_order** - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. заказы переносятся и имеют раные даты доставки)

**timeslot_number** - нумерация кол-ва попыток доставить в плановую дату доставки. Если доставка не была осуществлена, то заказ переносится на новую дату

**result_data_order** - дата, в которую заказ был доставлен клиенту

**delivery_type** - выбранный клиентом способ получения заказа (курьерка или самовывоз)

**carrier_name** - перевозчик, которым заказ доставляется клиенту

**seller_ID** - уникальный идентификатор продавца

**order_status** - последний актуальный статус заказа (фиксируется во всех строках последний статус заказа)

**customer_cluster** - региональная принадлежность клиента

**warehouse_cluster** - региональная принадлежность продавца

Таблица **product_online** содержит данные о товарах в заказе.

**number_order** - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. так как в одном заказе может быть несколько товаров)

**product_ID** - уникальный номер товара (В столбце номер может повторяться, т.к. так как один товар может быть в заказах нескольких клиентов)

**product_price** - стоимость одной единицы товара в рублях

**amount** - количество единиц товара в заказе

Таблица **returns_online** содержит данные о возвратах

**number_order** - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. так как в одном заказе может быть несколько товаров)

**product_ID** - уникальный номер товара (в столбце номер может повторяться, т.к. так как один товар может быть в заказах нескольких клиентов)

**amount_return** - количество единиц товара, которые были возвращены (не больше, чем количество единиц товара, приобретенных в указаном заказе)

**return_date** - дата совершения возврата
